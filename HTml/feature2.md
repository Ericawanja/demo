correcting the bug 


adding a few more changes 